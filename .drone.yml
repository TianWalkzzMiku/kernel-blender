kind: pipeline
name: Mystic Kernel (MSM-4.4)

steps:
- name: Building Mystic Kernel
  image: okta10/docker:ubuntu
  environment: 
    GH_TOKEN:
      from_secret: GH_TOKEN
    TG_BOT_TOKEN:
      from_secret: TG_BOT_TOKEN
    TG_CHAT_ID:
      from_secret: TG_CHAT_ID

  commands:
    - "wget https://raw.githubusercontent.com/okta-10/scripts/main/build-ci/kernel-4.4/doStart.sh"
    - bash doStart.sh beta gcc
    - cd kernel
    - "wget https://raw.githubusercontent.com/okta-10/scripts/main/build-ci/kernel-4.4/doBuild_dtb.sh"
    - bash doBuild_dtb.sh a26x gcc qpnp
    - bash doBuild_dtb.sh lavender gcc qpnp
    - bash doBuild_dtb.sh tulip gcc qpnp
    - bash doBuild_dtb.sh whyred gcc qpnp
    - git apply qti.patch
    - bash doBuild_dtb.sh a26x gcc qti
    - bash doBuild_dtb.sh lavender gcc qti
    - bash doBuild_dtb.sh tulip gcc qti
    - bash doBuild_dtb.sh whyred gcc qti
    - git restore .
    - "wget https://raw.githubusercontent.com/okta-10/scripts/main/build-ci/kernel-4.4/doBuild.sh"
    - bash doBuild.sh a26x newcam gcc
    - bash doBuild.sh a26x oldcam gcc
    - bash doBuild.sh a26x tencam gcc
    - bash doBuild.sh lavender newcam gcc
    - bash doBuild.sh lavender oldcam gcc
    - bash doBuild.sh tulip newcam gcc
    - bash doBuild.sh tulip oldcam gcc
    - bash doBuild.sh whyred newcam gcc
    - bash doBuild.sh whyred oldcam gcc
    - git apply oc.patch
    - bash doBuild_dtb.sh tulip gcc qpnp
    - bash doBuild_dtb.sh whyred gcc qpnp
    - git apply qti.patch
    - bash doBuild_dtb.sh tulip gcc qti
    - bash doBuild_dtb.sh whyred gcc qti
    - git restore .
    - bash doBuild.sh tulip newcam oc gcc
    - bash doBuild.sh tulip oldcam oc gcc
    - bash doBuild.sh whyred newcam oc gcc
    - bash doBuild.sh whyred oldcam oc gcc
    - "wget https://raw.githubusercontent.com/okta-10/scripts/main/build-ci/kernel-4.4/doFinal.sh"
    - bash doFinal.sh gcc
